Tag by lifetime stage:
New:
  In first 42 days (unless their enquiry gets closed)
Lapsed:
    Has made a booking but not in last 14 months
Dormant:
  Never made a booking, no enquiry for 12 months. OR no booking for 24 months.
ActiveNoBooking:
  Otherwise and didn't make a booking
ActiveBooking:
  Otherwise and made a booking

Some sort of aggregation by customer --> arrays and then batch updates.

Customers